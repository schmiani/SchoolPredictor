USE school;
CREATE OR REPLACE VIEW AllYears AS SELECT a.DBN, a.SCHOOL_LEVEL, CAST(a.2012_2013_OVERALL_SCORE AS DECIMAL(4,1)) AS 2012_13_SCORE, CAST(b.2011_2012_OVERALL_SCORE AS DECIMAL(4,1)) AS 2011_12_SCORE, CAST(c.2010_2011_OVERALL_SCORE AS DECIMAL(4,1)) AS 2010_11_SCORE, CAST(d.2009_2010_OVERALL_SCORE AS DECIMAL(4,1))  AS 2009_10_SCORE, CAST(e.OVERALL_SCORE AS DECIMAL(4,1)) AS 2008_09_SCORE,CAST(f.OVERALL_SCORE AS DECIMAL(4,1)) AS 2007_08_SCORE, CAST(g.OVERALL_SCORE AS DECIMAL(4,1)) AS 2006_07_SCORE FROM All_2013 a JOIN All_2012 b ON a.DBN=b.DBN AND a.SCHOOL_LEVEL=b.SCHOOL_LEVEL JOIN All_2011 c on b.DBN=c.DBN AND b.SCHOOL_LEVEL=c.SCHOOL_LEVEL JOIN All_2010 d on c.DBN=d.DBN AND c.SCHOOL_LEVEL=d.SCHOOL_LEVEL JOIN All_2009 e on d.DBN=e.DBN AND d.SCHOOL_LEVEL=e.SCHOOL_LEVEL JOIN All_2008 f on e.DBN=f.DBN AND e.SCHOOL_LEVEL=f.SCHOOL_LEVEL JOIN All_2007 g on f.DBN=g.DBN AND f.SCHOOL_LEVEL=g.SCHOOL_LEVEL;
SELECT * FROM allyears LIMIT 5;
SELECT MAX(2006_2007_OVERALL_SCORE) FROM allyears;